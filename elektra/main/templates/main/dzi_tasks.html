{% extends 'main/dzi_base.html' %}
{% load static %}

{% block left_panel %}
{% include 'main/dzi_left_panel_profile.html' %}
{% endblock %}

{% block lef_panel_icon%}
<div class="expand-btn-grp @@display-class" xmlns="http://www.w3.org/1999/html">
                                    <button class="bg-solid-primary popup-dashboardright-btn">
                                        <i class="feather-sidebar right"></i>
                                    </button>
                                </div>
{% endblock %}

{% block main_content %}
            <!-- Main content -->
            <div class="rbt-main-content">
                <div class="rbt-daynamic-page-content">
                    <!-- Start Breadcarumb area  -->
                    <div class="chatenai-separator">
                        <img class="w-100 separator-dark"
                             src="{% static 'assets/images/separator/separator-top.svg' %}" alt="separator">
                        <img class="w-100 separator-light"
                             src="{% static 'assets/images/light/separator/separator-top.svg' %}" alt="separator">
                    </div>
                    <div class="breadcrumb-area breadcarumb-style1 pt--30 pb--30">
                        <div class="container">
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="breadcrumb-inner text-center">
                                        <h1 class="title theme-gradient h2">Тестoви въпроси</h1>
                                        <ul class="page-list">
                                            <li class="rainbow-breadcrumb-item"><a href="{% url 'dzi_home' %}">Начало</a></li>
                                            <li class="rainbow-breadcrumb-item active">Въпроси</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- End Breadcarumb area  -->
                    <div class="chatenai-separator">
                        <img class="w-100 separator-dark" src="{% static 'assets/images/separator/separator-bottom.svg' %}" alt="separator">
                        <img class="w-100 separator-light" src="{% static 'assets/images/light/separator/separator-bottom.svg' %}" alt="separator">
                    </div>
{% verbatim %}
                    <!-- Dashboard Center Content -->
                    <div class="rbt-dashboard-content">
                        <div class="content-page">
                            <!-- Точки от темата  -->
                            <div class="chat-box-list pt--30" id="chatContainer"
                                 v-for="(item, item_idx) in theme">
                                <!-- Заглавна част -->
                                <div class="chat-box author-speech bg-flashlight">
                                    <div class="inner">
                                        <div class="chat-section">
                                            <div class="chat-content">
                                                <h6 class="title">[[item.item]]. [[item.title]]</h6>
                                                <p>Критерии за оценяване: <br>[[item.criterion]] </p>
                                                <div class="rainbow-pricing-detailed-area">
                                                    <div class="row">
                                                        <div class="col-lg-12">
                                                            <div class="section-title text-left mb--30" data-sal="slide-up" data-sal-duration="400" data-sal-delay="150">
                                                                <p class="title w-600 mb--0">Брой тестови задачи по равнища </p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row row--15">
                                                        <div class="col-lg-12">
                                                            <div class="rainbow-compare-table style-1">
                                                                <table class="table-responsive">
                                                                    <thead>
                                                                        <tr>
                                                                            <th></th>
                                                                            <th class="sm-radius-top-left color-level-1">
                                                                                Знание<br>(0 – 2 т.)</th>
                                                                            <th class="color-level-2">
                                                                                Разбиране<br>(0 – 4 т.)</th>
                                                                            <th class="color-level-3">
                                                                                Приложение<br>(0 – 6 т.)</th>
                                                                            <th class="sm-radius-top-right color-level-4">
                                                                                Анализ<br>(0 – 8 т.)
                                                                            </th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        <tr>
                                                                            <td>по НИП</td>
                                                                            <td>[[item.knowledge]]</td>
                                                                            <td>[[item.comprehension]]</td>
                                                                            <td>[[item.application]]</td>
                                                                            <td>[[item.analysis]]</td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td>в БД</td>
                                                                            <td :class="{'bg-color-good': verifyQuestionQty(1, item_idx, 3),
                                                                                         'bg-color-mid': verifyQuestionQty(1, item_idx, 2),
                                                                                         'bg-color-bad': verifyQuestionQty(1, item_idx, 1),
                                                                                         }">
                                                                                [[item.q_knowledge]]</td>
                                                                            <td :class="{'bg-color-good': verifyQuestionQty(2, item_idx, 3),
                                                                                         'bg-color-mid': verifyQuestionQty(2, item_idx, 2),
                                                                                         'bg-color-bad': verifyQuestionQty(2, item_idx, 1),
                                                                                         }">
                                                                                [[item.q_comprehension]]</td>
                                                                            <td :class="{'bg-color-good': verifyQuestionQty(3, item_idx, 3),
                                                                                         'bg-color-mid': verifyQuestionQty(3, item_idx, 2),
                                                                                         'bg-color-bad': verifyQuestionQty(3, item_idx, 1),
                                                                                         }">
                                                                                [[item.q_application]]</td>
                                                                            <td :class="{'bg-color-good': verifyQuestionQty(4, item_idx, 3),
                                                                                         'bg-color-mid': verifyQuestionQty(4, item_idx, 2),
                                                                                         'bg-color-bad': verifyQuestionQty(4, item_idx, 1),
                                                                                         }">
                                                                                [[item.q_analysis]]</td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td></td>
                                                                            <td><!-- data-bs-toggle="modal" data-bs-target="#editQuestionModal" -->
                                                                                <button class="react-btn btn-default btn-small btn-border"
                                                                                        @click="make_new_q(item.id, 1)"
                                                                                        data-bs-toggle="modal" data-bs-target="#editQuestionModal">
                                                                                        Добави
                                                                                </button>
                                                                            </td>
                                                                            <td>
                                                                                <button class="react-btn btn-default btn-small btn-border"
                                                                                        @click="make_new_q(item.id, 2)"
                                                                                        data-bs-toggle="modal" data-bs-target="#editQuestionModal">
                                                                                        Добави
                                                                                </button>
                                                                            </td>
                                                                            <td>
                                                                                <button class="react-btn btn-default btn-small btn-border"
                                                                                        @click="make_new_q(item.id, 3)"
                                                                                        data-bs-toggle="modal" data-bs-target="#editQuestionModal">
                                                                                        Добави
                                                                                </button>
                                                                            </td>
                                                                            <td>
                                                                                <button class="react-btn btn-default btn-small btn-border"
                                                                                        @click="make_new_q(item.id, 4)"
                                                                                        data-bs-toggle="modal" data-bs-target="#editQuestionModal">
                                                                                        Добави
                                                                                </button>
                                                                            </td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- списък на въпросите на подтемата по нива на Блум -->
                                <div v-for="level in 4" :key="level"   :id="'T'+item_idx+'L'+level">
                                    <!-- ако няма въпроси от това ниво -->
                                    <div class="chat-box ai-speech bg-flashlight mt--10" v-if="getQuestionsQty(level, item_idx)==0">
                                        <div class="inner top-flashlight leftside light-xl">
                                            <div class="chat-section generate-section">
                                                <div class="chat-content">
                                                    <h6 class="title color-text-off mb--0">Няма създадени въпроси от ниво [[getLevelName(level)]]</h6>
                                               </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- ако има въпроси от това ниво -->
                                    <div  v-else>
                                        <div v-for="(qst, qst_idx) in item.tasks">
                                            <div class="chat-box ai-speech bg-flashlight mt--10"
                                                 v-if="(qst.level==level)&&(haveToShow(item_idx, qst_idx))"
                                                 :id="'qt'+item_idx+'_'+qst_idx">
                                                <!-- показвам всички въпроси от тема/точка/ниво (theme/item/level) qst -->
                                                <div class="inner top-flashlight leftside light-xl">
                                                    <!-- Заглавна част - параметри на въпроса -->
                                                    <div class="chat-section generate-section">
                                                        <div class="chat-content">
                                                            <!-- Заглавен ред -->
                                                            <div class="row">
                                                                <div class="col-lg-6 col-md-6 col-sm-6 col-12">
                                                                    <h5 class="title"
                                                                :class="{'color-level-1': qst.level==1,
                                                                         'color-level-2': qst.level==2,
                                                                         'color-level-3': qst.level==3,
                                                                         'color-level-4': qst.level==4,
                                                                        }">
                                                                Въпрос #[[ qst.id ]]</h5>
                                                                </div>
                                                                <div class="col-lg-6 col-md-6 col-sm-6 col-12" style="text-align: right;">
                                                                    <span style="font-size:9px; color: #C231A1;" v-if="qst.showLevel==-1"> Не се използва във Вашето училище</span>
                                                                    <span style="font-size:9px; color: #0d6efd;" v-if="qst.showLevel==0"> Въпрос от друго училище, използван и във Вашето</span>
                                                                </div>
                                                            </div>
                                                            <!-- Група/Ниво -->
                                                            <div class="row mb--10">
                                                                <div class="col-lg-4 col-md-4 col-sm-4 col-12">
                                                                    <span v-if="qst.group>0">Група: [[ qst.group ]]</span>
                                                                    <div class="rbt-checkbox-wrapper" v-if="showAddToGroup(item_idx, qst_idx)"
                                                                         @click="saveGroup(item_idx, qst_idx)">
                                                                        <a :href="'#qt'+grouping.item_num+'_'+grouping.task_num">
                                                                            <input :id="'group_'+item.id+'_'+qst.id"
                                                                                   type="checkbox">
                                                                            <label :for="'group_'+item.id+'_'+qst.id">
                                                                                включи в група
                                                                            </label></a>
                                                                    </div>
                                                                </div>
                                                                <div class="col-lg-2 col-md-2 col-sm-2 col-12" style="text-align: center;">
                                                                </div>
                                                                <div class="col-lg-6 col-md-6 col-sm-6 col-12 " style="text-align: right;">
                                                                   <span class="react-btn btn-default btn-small btn-border"
                                                                         :class="{'color-level-1': qst.level==1,
                                                                                  'color-level-2': qst.level==2,
                                                                                  'color-level-3': qst.level==3,
                                                                                  'color-level-4': qst.level==4,
                                                                                  }">
                                                                         Въпрос от ниво [[getLevelName(qst.level)]] - [[2*qst.level]] т.</span>
                                                               </div>
                                                            </div>
                                                            <!-- Контекст -->
                                                            <div class="chat-content mb--10" v-if="qst.context!=NULL">
                                                                <div class="row">
                                                                    <!-- картинка и текст -->
                                                                    <div class="row mb--10" v-if="qst.context.textWrap=='n'">
                                                                        <p class="mb--10">[[ qst.context.text ]]</p>
                                                                        <div class="col-lg-12 img-box  d-flex justify-content-center">
                                                                            <img class="radius" :src="qst.context.picture">
                                                                        </div>
                                                                    </div>
                                                                    <div class="row mb--10" v-if="qst.context.textWrap=='s'">
                                                                        <div class="col-lg-12 img-box  d-flex justify-content-center">
                                                                            <img class="radius" :src="qst.context.picture">
                                                                        </div>
                                                                        <p class="mt--10">[[ qst.context.text ]]</p>
                                                                    </div>
                                                                    <div class="row mb--10" v-if="qst.context.textWrap=='e'">
                                                                        <div class="col-lg-6 img-box  d-flex justify-content-center">
                                                                            [[ qst.context.text ]]
                                                                        </div>
                                                                        <div class="col-lg-6 img-box  d-flex justify-content-center">
                                                                            <img class="radius" :src="qst.context.picture">
                                                                        </div>
                                                                    </div>
                                                                    <div class="row mb--10" v-if="qst.context.textWrap=='w'">
                                                                        <div class="col-lg-6 img-box  d-flex justify-content-center">
                                                                            <img class="radius" :src="qst.context.picture">
                                                                        </div>
                                                                        <div class="col-lg-6 img-box  d-flex justify-content-center">
                                                                            [[ qst.context.text ]]
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                       </div>
                                                    </div>
                                                    <!-- Въпрос -->
                                                    <div class="chat-section">
                                                        <!-- Въпрос тип 1 - изброени отговори без картинка -->
                                                        <div class="chat-content" v-if="qst.type==1">
                                                            <p class="mb--20">[[ qst.text ]]</p>
                                                            <div class="row">
                                                                <div class="col-lg-1"></div>
                                                                <div class="col-lg-11">
                                                                    <!-- Опции/отговори -->
                                                                    <div class="rbt-checkbox-wrapper" v-for="option in qst.options">
                                                                        <input :id="'option_'+item.id+'_'+qst.id+'_'+option.id"
                                                                               type="checkbox" disabled :checked="option.checked">
                                                                        <label :for="'option_'+item.id+'_'+qst.id+'_'+option.id">
                                                                            <span :class="{'color-No': !option.checked, 'color-Ok': option.checked}">[[ option.leading_char ]]. [[ option.text ]]</span>
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!-- Въпрос тип 2 - изброени отговори с картинка -->
                                                        <div class="chat-content" v-else-if="qst.type==2">
                                                            <div class="row">
                                                                <!-- картинка и текст -->
                                                                <div class="row mb--10" v-if="qst.textWrap=='n'">
                                                                    <p class="mb--10">[[ qst.text ]]</p>
                                                                    <div class="col-lg-12 img-box  d-flex justify-content-center">
                                                                        <img class="radius" :src="qst.picture">
                                                                    </div>
                                                                </div>
                                                                <div class="row mb--10" v-if="qst.textWrap=='s'">
                                                                    <div class="col-lg-12 img-box  d-flex justify-content-center">
                                                                        <img class="radius" :src="qst.picture">
                                                                    </div>
                                                                    <p class="mt--10">[[ qst.text ]]</p>
                                                                </div>
                                                                <div class="row mb--10" v-if="qst.textWrap=='e'">
                                                                    <div class="col-lg-6 img-box  d-flex justify-content-center">
                                                                        [[ qst.text ]]
                                                                    </div>
                                                                    <div class="col-lg-6 img-box  d-flex justify-content-center">
                                                                        <img class="radius" :src="qst.picture">
                                                                    </div>
                                                                </div>
                                                                <div class="row mb--10" v-if="qst.textWrap=='w'">
                                                                    <div class="col-lg-6 img-box  d-flex justify-content-center">
                                                                        <img class="radius" :src="qst.picture">
                                                                    </div>
                                                                    <div class="col-lg-6 img-box  d-flex justify-content-center">
                                                                        [[ qst.text ]]
                                                                    </div>
                                                                </div>
                                                                <!-- отговори -->
                                                                <div class="row">
                                                                    <div class="col-lg-1"></div>
                                                                    <div class="col-lg-11">
                                                                        <!-- Опции/отговори -->
                                                                        <div class="rbt-checkbox-wrapper" v-for="option in qst.options">
                                                                            <input :id="'option_'+item.id+'_'+qst.id+'_'+option.id"
                                                                                   type="checkbox" disabled :checked="option.checked">
                                                                            <label :for="'option_'+item.id+'_'+qst.id+'_'+option.id">
                                                                                <span :class="{'color-No': !option.checked, 'color-Ok': option.checked}">[[ option.leading_char ]]. [[ option.text ]]</span>
                                                                            </label>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!-- Въпрос тип 3 - съпоставяне без картинка -->
                                                        <div class="chat-content" v-else-if="qst.type==3">
                                                            <p class="mb--20">[[ qst.text ]]</p>
                                                            <div class="row">
                                                                <div class="col-lg-1"></div>
                                                                <div class="col-lg-11">
                                                                    <!-- Опции/отговори -->
                                                                    <div class="rbt-checkbox-wrapper" v-for="option in qst.options">
                                                                        <div class="row">
                                                                            <div class="col-lg-5 d-flex align-items-center">
                                                                                [[ option.leading_char ]]. [[ option.text ]]
                                                                            </div>
                                                                            <div class="col-lg-7 btn-grp">
                                                                                <button class="react-btn btn-default btn-small btn-border"
                                                                                        type="button"
                                                                                        style="color: green; border-color: #013401;">
                                                                                    [[ option.value ]]</button>&nbsp;
                                                                                [[ option.value_name ]]
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!-- Въпрос тип 4 - съпоставяне с картинка -->
                                                        <div class="chat-content" v-else-if="qst.type==4">
                                                            <div class="row">
                                                                <!-- картинка и текст -->
                                                                <div class="row mb--10" v-if="qst.textWrap=='n'">
                                                                    <p class="mb--10">[[ qst.text ]]</p>
                                                                    <div class="col-lg-12 img-box  d-flex justify-content-center">
                                                                        <img class="radius" :src="qst.picture">
                                                                    </div>
                                                                </div>
                                                                <div class="row mb--10" v-if="qst.textWrap=='s'">
                                                                    <div class="col-lg-12 img-box  d-flex justify-content-center">
                                                                        <img class="radius" :src="qst.picture">
                                                                    </div>
                                                                    <p class="mt--10">[[ qst.text ]]</p>
                                                                </div>
                                                                <div class="row mb--10" v-if="qst.textWrap=='e'">
                                                                    <div class="col-lg-6 img-box  d-flex justify-content-center">
                                                                        [[ qst.text ]]
                                                                    </div>
                                                                    <div class="col-lg-6 img-box  d-flex justify-content-center">
                                                                        <img class="radius" :src="qst.picture">
                                                                    </div>
                                                                </div>
                                                                <div class="row mb--10" v-if="qst.textWrap=='w'">
                                                                    <div class="col-lg-6 img-box  d-flex justify-content-center">
                                                                        <img class="radius" :src="qst.picture">
                                                                    </div>
                                                                    <div class="col-lg-6 img-box  d-flex justify-content-center">
                                                                        [[ qst.text ]]
                                                                    </div>
                                                                </div>
                                                                <!-- отговори -->
                                                                <div class="row">
                                                                    <div class="col-lg-1"></div>
                                                                    <div class="col-lg-11">
                                                                    <!-- Опции/отговори -->
                                                                    <div class="rbt-checkbox-wrapper" v-for="option in qst.options">
                                                                        <div class="row">
                                                                            <div class="col-lg-2 d-flex align-items-end  btn-grp">
                                                                               <button class="react-btn btn-default btn-small btn-border"
                                                                                        type="button"
                                                                                        style="color: green; border-color: #013401;">
                                                                                    [[ option.value ]]</button>&nbsp;
                                                                            </div>
                                                                            <div class="col-lg-10">
                                                                                [[ option.value_name ]]
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!-- Въпрос тип 5 - изброени отговори без картинка -->
                                                        <div class="chat-content" v-else>
                                                            <p class="mb--20">[[ qst.text ]]</p>
                                                            <div class="row">
                                                                <div class="row mt-5"><div>Допустими отговори:</div> </div>
                                                                <div class="col-lg-2 d-flex align-items-end"></div>
                                                                <div class="col-lg-10">
                                                                    <!-- Опции/отговори -->
                                                                    <div class="rbt-checkbox-wrapper" v-for="(option, idx) in qst.options">
                                                                        [[ idx+1 ]]. [[ option.value ]]
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- функционални бутони -->
                                                    <div class="row mt--10">
                                                        <!-- comments -->
                                                        <div class="col-lg-2 col-md-2 col-sm-2 col-6">
                                                            <button type="button"
                                                                    class="react-btn btn-default btn-small btn-border dropdown-toggle"
                                                                    style="font-size: 12px;"
                                                                    data-bs-toggle="dropdown" aria-expanded="false"
                                                                    @click="remark.text=''; remark.task_id=qst.id;">
                                                                <i class="feather-file-plus"></i><span>&nbspКоментар&nbsp</span>
                                                            </button>
                                                            <ul class="dropdown-menu">
                                                                <li><a class="dropdown-item delete-item"
                                                                       data-bs-toggle="modal" data-bs-target="#listRemarksModal"
                                                                       @click="loadRemarks(qst.id)">
                                                                    <i class="feather-server"></i> Покажи всички коментари</a></li>
                                                                <li><a class="dropdown-item delete-item"
                                                                       data-bs-toggle="modal" data-bs-target="#newRemarkModal">
                                                                    <i class="feather-edit"></i> Добави коментар</a></li>
                                                            </ul>
                                                        </div>
                                                        <!-- do not accept -->
                                                        <div class="col-lg-2 col-md-2 col-sm-2 col-6">
                                                            <button type="button"
                                                                    class="react-btn btn-default btn-small btn-border dropdown-toggle"
                                                                    style="font-size: 12px; padding-left: 10px;"
                                                                    data-bs-toggle="dropdown" aria-expanded="false"
                                                                    @click="remark.text=''; remark.task_id=qst.id;"
                                                                    v-if="theme[item_idx].tasks[qst_idx].showLevel!=-1">
                                                                <i class="feather-file-plus"></i><span>Групиране</span>
                                                            </button>
                                                            <ul class="dropdown-menu">
                                                                <li><a class="dropdown-item delete-item"
                                                                       @click="addToGroup(item_idx, qst_idx)"
                                                                       v-if="(qst.showLevel != -1)&&(qst.group==0)">
                                                                    <i class="feather-server"></i> Добави към група от взаимно изключващи се въпроси</a></li>
                                                                <li><a class="dropdown-item delete-item"
                                                                       v-if="(qst.showLevel != -1)&&(qst.group!=0)"
                                                                       @click="clearGroup(item_idx, qst_idx)">
                                                                    <i class="feather-edit"></i> Извади от група от взаимно изключващи се въпроси</a></li>
                                                                <li><a class="dropdown-item"
                                                                       data-bs-toggle="modal" data-bs-target="#listGroupModal"
                                                                       @click="temp_int=qst.group"
                                                                       v-if="(qst.showLevel != -1)&&(qst.group!=0)">
                                                                    <i class="feather-edit"></i> Покажи списък на въпросите в групата</a></li>
                                                            </ul>
                                                        </div>
                                                        <!-- accept -->
                                                        <div class="col-lg-2 col-md-2 col-sm-2 col-6">
                                                            <button class="react-btn btn-default btn-small btn-border bg-color-secondary"
                                                                    style="font-size: 12px;" v-if="theme[item_idx].tasks[qst_idx].showLevel==0"
                                                                    @click="useQuestion(qst.id, user.school, 'remove')">
                                                                <i class="feather-upload-cloud"></i><span>&nbspИзключи&nbsp</span>
                                                            </button>
                                                            <button class="react-btn btn-default btn-small btn-border bg-color-primary"
                                                                    style="font-size: 12px;" v-if="theme[item_idx].tasks[qst_idx].showLevel==-1"
                                                                    @click="useQuestion(qst.id, user.school, 'add')">
                                                                <i class="feather-download-cloud"></i><span>&nbspПолзвай</span>
                                                            </button>
                                                        </div>
                                                        <!-- copy -->
                                                        <div class="col-lg-2 col-md-2 col-sm-2 col-6">
                                                            <button class="react-btn btn-default btn-small btn-border bg-color-warning"
                                                                    @click="copyQuestion(qst.id)"
                                                                    data-bs-toggle="modal" data-bs-target="#editQuestionModal"
                                                                    style="font-size: 12px;">
                                                                <i class="feather-copy"></i><span>&nbspКопирай&nbsp</span>
                                                            </button>
                                                        </div>
                                                        <!-- delete -->
                                                        <div class="col-lg-2 col-md-2 col-sm-2 col-6">
                                                            <button class="react-btn btn-default btn-small btn-border bg-color-danger"
                                                                    style="font-size: 12px;" v-if="theme[item_idx].tasks[qst_idx].showLevel==1"
                                                                    @click="deleteTask(qst.id)">
                                                                <i class="feather-delete"></i><span>&nbspИзтрий&nbsp&nbsp</span>
                                                            </button>
                                                        </div>
                                                        <!-- edit -->
                                                        <div class="col-lg-2 col-md-2 col-sm-2 col-6">
                                                            <button class="react-btn btn-default btn-small btn-border bg-color-success"
                                                                    @click="make_q(item_idx, qst_idx)"
                                                                    data-bs-toggle="modal" data-bs-target="#editQuestionModal"
                                                                    style="font-size: 12px;" v-if="editEnabled(item_idx,qst_idx)">
                                                                <i class="feather-edit"></i><span>&nbspПромени</span>
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="rbt-static-bar collapse-width">
                            <!-- End Header Top Area  -->
                            <ul class="staticbar-btn-grp d-md-flex">
                                <li>
                                    <button class="btn-default btn-small btn-border"
                                            data-bs-toggle="modal" data-bs-target="#themeSelectModal">
                                        <span>Избери друга тема</span>
                                    </button>
                                </li>
                                <li>
                                    <a class="btn-default btn-small btn-border" @click="setShowMode(0)">
                                        <span>Покажи всички</span>
                                    </a>
                                </li>
                                <li>
                                    <a class="btn-default btn-small btn-border" @click="setShowMode(2)">
                                        <span>Покажи за училището</span>
                                    </a>
                                </li>
                                <li>
                                    <a class="btn-default btn-small btn-border" @click="setShowMode(1)">
                                        <span>Покажи неизползвани</span>
                                    </a>
                                </li>
                            </ul>
                            <div id="my_switcher" class="my_switcher">
                                <ul>
                                    {% endverbatim %}
                                    <li>
                                        <a href="javascript: void(0);" data-theme="light" class="setColor light">
                                            <img src="{% static 'assets/images/light/switch/sun-01.svg' %}" alt="Sun images"><span title="Light Mode"> Light</span>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="javascript: void(0);" data-theme="dark" class="setColor dark">
                                            <img src="{% static 'assets/images/light/switch/vector.svg' %}" alt="Vector Images"><span title="Dark Mode">
                                        Dark</span>
                                        </a>
                                    </li>
                                    {% verbatim %}
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Dashboard Right Content -->
                    <div class="rbt-right-side-panel popup-dashboardright-section">

                        <div class="right-side-top">
                            <h6 class="title">Съдържание на темата:</h6>
                        </div>
                        <div class="right-side-bottom mb--200">
                            <div class="chat-history-section"
                                 v-for="(theme_item, idx) in theme">
                                <h6 class="title">[[theme_item.item]]. [[theme_item.title]]</h6>
                                <ul class="chat-history-list">
                                    <li class="history-box active">
                                        <div class="dropdown history-box-dropdown">
                                            <button type="button" class="more-info-icon dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                                                <i class="feather-more-horizontal"></i>
                                            </button>
                                            <ul class="dropdown-menu">
                                                <li><a class="dropdown-item"
                                                       @click="make_new_q(theme_item.id, 1)"
                                                       data-bs-toggle="modal" data-bs-target="#editQuestionModal">
                                                    <i class="feather-file-plus"></i> Добави</a>
                                                </li>
                                                <li><a class="dropdown-item" :href="'#T'+idx+'L1'"><i class="feather-corner-up-left"></i> Покажи</a></li>
                                            </ul>
                                        </div>
                                        Знание
                                        <span :class="{'bg-color-good': verifyQuestionQty(1, idx, 3),
                                                       'bg-color-mid': verifyQuestionQty(1, idx, 2),
                                                       'bg-color-bad': verifyQuestionQty(1, idx, 1),
                                                      }">
                                            &nbsp;[[theme_item.q_knowledge]] (мин.[[theme_item.knowledge]])&nbsp; </span>
                                    </li>
                                    <li class="history-box active">
                                        <div class="dropdown history-box-dropdown">
                                            <button type="button" class="more-info-icon dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                                                <i class="feather-more-horizontal"></i>
                                            </button>
                                            <ul class="dropdown-menu">
                                                <li><a class="dropdown-item"
                                                       @click="make_new_q(theme_item.id, 2)"
                                                       data-bs-toggle="modal" data-bs-target="#editQuestionModal">
                                                    <i class="feather-file-plus"></i> Добави</a>
                                                </li>
                                                <li><a class="dropdown-item" :href="'#T'+idx+'L2'"><i class="feather-corner-up-left"></i> Покажи</a></li>
                                            </ul>
                                        </div>
                                        Разбиране
                                        <span  :class="{'bg-color-good': verifyQuestionQty(2, idx, 3),
                                                       'bg-color-mid': verifyQuestionQty(2, idx, 2),
                                                       'bg-color-bad': verifyQuestionQty(2, idx, 1),
                                                       }">
                                            &nbsp;[[theme_item.q_comprehension]] (мин.[[theme_item.comprehension]])&nbsp; </span>
                                    </li>
                                    <li class="history-box active">
                                        <div class="dropdown history-box-dropdown">
                                            <button type="button" class="more-info-icon dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                                                <i class="feather-more-horizontal"></i>
                                            </button>
                                            <ul class="dropdown-menu">
                                                <li><a class="dropdown-item"
                                                       @click="make_new_q(theme_item.id, 3)"
                                                       data-bs-toggle="modal" data-bs-target="#editQuestionModal">
                                                    <i class="feather-file-plus"></i> Добави</a>
                                                </li>
                                                <li><a class="dropdown-item" :href="'#T'+idx+'L3'"><i class="feather-corner-up-left"></i> Покажи</a></li>
                                            </ul>
                                        </div>
                                        Приложение
                                        <span :class="{'bg-color-good': verifyQuestionQty(3, idx, 3),
                                                       'bg-color-mid': verifyQuestionQty(3, idx, 2),
                                                       'bg-color-bad': verifyQuestionQty(3, idx, 1),
                                                       }">
                                            &nbsp;[[theme_item.q_application]] (мин.[[theme_item.application]])&nbsp; </span>
                                    </li>
                                    <li class="history-box active">
                                        <div class="dropdown history-box-dropdown">
                                            <button type="button" class="more-info-icon dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                                                <i class="feather-more-horizontal"></i>
                                            </button>
                                            <ul class="dropdown-menu">
                                                <li><a class="dropdown-item"
                                                       @click="make_new_q(theme_item.id, 4)"
                                                       data-bs-toggle="modal" data-bs-target="#editQuestionModal">
                                                    <i class="feather-file-plus"></i> Добави</a>
                                                </li>
                                                <li><a class="dropdown-item" :href="'#T'+idx+'L4'"><i class="feather-corner-up-left"></i> Покажи</a></li>
                                            </ul>
                                        </div>
                                        Анализ
                                        <span  :class="{'bg-color-good': verifyQuestionQty(4, idx, 3),
                                                       'bg-color-mid': verifyQuestionQty(4, idx, 2),
                                                       'bg-color-bad': verifyQuestionQty(4, idx, 1),
                                                       }">
                                            &nbsp;[[theme_item.q_analysis]] (мин.[[theme_item.analysis]])&nbsp; </span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
{% endverbatim %}
                </div>
            </div>
{% endblock %}

{% block modals %}
        <!-- Редактиране на въпрос -->
        <div id="editQuestionModal" class="modal rbt-modal-box like-modal fade" tabindex="-1">
{% verbatim %}
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content wrapper top-flashlight leftside light-xl">
                    <!-- Заглавна част - параметри на въпроса -->
                    <h5 class="title"
                        :class="{'color-level-1': question.level==1,
                                 'color-level-2': question.level==2,
                                 'color-level-3': question.level==3,
                                 'color-level-4': question.level==4,
                                }">
                        Въпрос #[[ question.id ]]</h5>
                    <div class="row mb--20">
                        <div class="col-lg-4 col-md-4 col-sm-4 col-12">
                            <button type="button" class="react-btn btn-default btn-small btn-border dropdown-toggle"
                                    data-bs-toggle="dropdown" aria-expanded="false" >
                                Равнище по Блум <i class="feather-more-vertical"></i>
                            </button>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item color-level-1" @click="question.level=1">Знание (2т.)</a></li>
                                <li><a class="dropdown-item color-level-2" @click="question.level=2">Разбиране (4т.)</a></li>
                                <li><a class="dropdown-item color-level-3" @click="question.level=3">Приложение (6т.)</a></li>
                                <li><a class="dropdown-item color-level-4" @click="question.level=4">Анализ (8т.)</a></li>
                            </ul>
                        </div>
                        <div class="col-lg-4 col-md-4 col-sm-4 col-12" style="text-align: center;">
                           <button type="button" class="react-btn btn-default btn-small btn-border dropdown-toggle"
                                   data-bs-toggle="dropdown" aria-expanded="false" >
                               Тип на въпроса <i class="feather-more-vertical"></i>
                           </button>
                           <ul class="dropdown-menu">
                               <li><a class="dropdown-item delete-item"  @click="question.type=1">
                                   <i class="feather-server"></i> Въпрос от затворен тип с един или два верни отговора</a></li>
                               <li><a class="dropdown-item delete-item"  @click="question.type=2">
                                   <i class="feather-image"></i> Въпрос от затворен тип с един или два верни отговора с картинка</a></li>
                               <li><a class="dropdown-item delete-item"  @click="question.type=3">
                                   <i class="feather-shuffle"></i> Въпрос със съпоставяне</a></li>
                               <li><a class="dropdown-item delete-item"  @click="question.type=4">
                                   <i class="feather-film"></i> Въпрос за съпоставяне на елементи от картинка със зададени опции</a></li>
                               <li><a class="dropdown-item delete-item"  @click="question.type=5">
                                   <i class="feather-edit"></i> Въпрос с отворен отговор</a></li>
                           </ul>
                       </div>
                        <div class="col-lg-4 col-md-4 col-sm-4 col-12 " style="text-align: right;">
                           <span class="react-btn btn-default btn-small btn-border"
                                 :class="{'color-level-1': question.level==1,
                                          'color-level-2': question.level==2,
                                          'color-level-3': question.level==3,
                                          'color-level-4': question.level==4,
                                          }">
                                 Ниво [[getLevelName(question.level)]] - [[2*question.level]] т.</span>
                       </div>
                    </div>
                    <!-- Група -->
                    <div class="row" v-if="question.group>0">
                       <div class="col-lg-6 col-md-6 col-sm-6 col-12"></div>
                       <div class="col-lg-6 col-md-6 col-sm-6 col-12 d-flex align-items-center justify-content-end">
                           <div class="form-group">
                               <label>Група: [[ question.group ]]</label>
                           </div>
                       </div>
                   </div>
                    <!-- Контекст -->
                    <div class="row mb--5">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-12" style="text-align: right;">
                            <button type="button"
                                   class="react-btn btn-default btn-small btn-border dropdown-toggle"
                                   style="color: #0d6efd; border-color: rgb(7 3 144);"
                                   data-bs-toggle="dropdown" aria-expanded="false" >
                               Контекст <i class="feather-more-vertical"></i>
                           </button>
                            <ul class="dropdown-menu">
                               <li v-if="(context_edit_mode==0)&&(context_count>0)&&(question.ctx==null)">
                                   <a class="dropdown-item"  @click="context_edit_mode=1">
                                   <i class="feather-server"></i> Задаване на съществуващ контекст</a></li>

                               <li v-if="(context_edit_mode==0)&&(question.ctx==null)">
                                   <a class="dropdown-item" @click="newContext()">
                                   <i class="feather-file-plus"></i> Създаване на нов контекст</a></li>

                               <li v-if="(context_edit_mode==0)&&(context_count>0)&&(question.ctx!=null)&&
                                         (question.ctx.id>0)&&(question.ctx.author==user.school)">
                                   <a class="dropdown-item" @click="context_edit_mode=2">
                                   <i class="feather-repeat"></i> Редактиране на текущия контекст</a></li>

                               <li v-if="(context_edit_mode==0)&&(context_count>0)&&(question.ctx!=null)&&
                                         (question.ctx.id>0)&&(question.ctx.author!=user.school)">
                                   <a class="dropdown-item" @click="context_edit_mode=3">
                                   <i class="feather-shuffle"></i> Създаване на собствено копие</a></li>

                               <li v-if="(context_edit_mode==0)&&(context_count>0)&&(question.ctx!=null)&&(question.ctx.id>0)">
                                   <a class="dropdown-item delete-item" @click="context_edit_mode=4">
                                   <i class="feather-film"></i> Премахване на контекста</a></li>

                               <li v-if="context_edit_mode>0">
                                   <a class="dropdown-item delete-item"  @click="context_edit_mode=0">
                                   <i class="feather-chevrons-up"></i> Затвори </a></li>
                           </ul>
                        </div>
                    </div>
                    <!-- секция за редактиране на контекста  -->
                    <div v-if="context_edit_mode>0">
                        <!-- Избор на контекст от списък -->
                        <div class="modal-content wrapper top-flashlight leftside light-xl" v-if="context_edit_mode==1">
                            <h5 class="title">Избор/създаване на общ контекст за няколко въпроса</h5>
                            <div v-for="(item, item_idx) in theme">
                                <div v-for="(qst, qst_idx) in item.tasks">
                                    <div class="chat-box-edit bg-flashlight" v-if="qst.context!=NULL">
                                        <div class="inner top-flashlight leftside light-xl">
                                            <div class="chat-section generate-section">
                                                <!-- съдържание на контекста -->
                                                <div class="chat-content"  style="width: 85%;">
                                                    <div class="row">
                                                        <div class="col-lg-12 col-md-12 col-sm-12 col-12" style="text-align: right;">
                                                            <button type="button"
                                                                    class="react-btn btn-default btn-small btn-border"
                                                                    style="color: #0d6efd; border-color: rgb(7 3 144);"
                                                                    @click="setContext(item_idx,qst_idx)">
                                                                <i class="feather-check"></i>&nbsp;Избери
                                                            </button>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <!-- картинка и текст -->
                                                        <div class="row mb--10" v-if="qst.context.textWrap=='n'">
                                                            <p class="mb--10">[[ qst.context.text ]]</p>
                                                            <div class="col-lg-12 img-box  d-flex justify-content-center">
                                                                <img class="radius" :src="qst.context.picture">
                                                            </div>
                                                        </div>
                                                        <div class="row mb--10" v-if="qst.context.textWrap=='s'">
                                                            <div class="col-lg-12 img-box  d-flex justify-content-center">
                                                                <img class="radius" :src="qst.context.picture">
                                                            </div>
                                                            <p class="mt--10">[[ qst.context.text ]]</p>
                                                        </div>
                                                        <div class="row mb--10" v-if="qst.context.textWrap=='e'">
                                                            <div class="col-lg-6 img-box  d-flex justify-content-center">
                                                                [[ qst.context.text ]]
                                                            </div>
                                                            <div class="col-lg-6 img-box  d-flex justify-content-center">
                                                                <img class="radius" :src="qst.context.picture">
                                                            </div>
                                                        </div>
                                                        <div class="row mb--10" v-if="qst.context.textWrap=='w'">
                                                            <div class="col-lg-6 img-box  d-flex justify-content-center">
                                                                <img class="radius" :src="qst.context.picture">
                                                            </div>
                                                            <div class="col-lg-6 img-box  d-flex justify-content-center">
                                                                [[ qst.context.text ]]
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Откачане на контекст -->
                        <div class="modal-content wrapper top-flashlight leftside light-xl" v-if="context_edit_mode==4">
                            <div class="chat-box-edit bg-flashlight">
                                <div class="inner top-flashlight leftside light-xl">
                                    <div class="chat-section generate-section">
                                        <!-- съдържание на контекста -->
                                        <div class="chat-content"  style="width: 85%;">
                                            <div class="row">
                                               <div class="col-lg-12 col-md-12 col-sm-12 col-12">
                                                   <div class="btn-grp">
                                                       <span style="padding: 20px;text-align: justify;">
                                                           Ще бъде премахната връзката на контекста към този
                                                           въпрос. Данните за самия контекст и за въпроса ще
                                                           останат непроменени.</span>
                                                   </div>
                                               </div>
                                               <div class="col-lg-12 col-md-12 col-sm-12 col-12" style="text-align: right;">
                                                   <div class="btn-grp">
                                                       <button class="react-btn btn-default btn-small btn-border"
                                                               style="color: red; border-color: #5c0000d4;"
                                                               @click="clearContext()">
                                                           <i class="feather-x"></i>
                                                           <span>&nbsp;Премахни</span>
                                                       </button>
                                                   </div>
                                               </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Копиране на контекст -->
                        <div class="modal-content wrapper top-flashlight leftside light-xl" v-if="context_edit_mode==3">
                            <div class="chat-box-edit bg-flashlight">
                                <div class="inner top-flashlight leftside light-xl">
                                    <div class="chat-section generate-section">
                                        <!-- съдържание на контекста -->
                                        <div class="chat-content"  style="width: 85%;">
                                            <div class="row">
                                               <div class="col-lg-12 col-md-12 col-sm-12 col-12">
                                                   <div class="btn-grp">
                                                       <span style="padding: 20px;text-align: justify;">
                                                           Ще бъде създадено локално копие на този контекст, което при
                                                           необходимост ще можете да реактирате.</span>
                                                   </div>
                                               </div>
                                               <div class="col-lg-12 col-md-12 col-sm-12 col-12" style="text-align: right;">
                                                   <div class="btn-grp">
                                                       <button class="react-btn btn-default btn-small btn-border"
                                                               style="color: green; border-color: #013401;"
                                                               @click="context_edit_mode=0">
                                                           <i class="feather-x"></i>
                                                           <span>&nbsp;Копирай</span>
                                                       </button>
                                                   </div>
                                               </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Редактиране на контекст -->
                        <div class="modal-content wrapper top-flashlight leftside light-xl" v-if="context_edit_mode==2">
                            <div class="chat-box-edit bg-flashlight">
                                <div class="inner top-flashlight leftside light-xl">
                                    <div class="chat-section generate-section">
                                        <!-- съдържание на контекста -->
                                        <div class="chat-content"  style="width: 85%;">
                                            <!-- Картинка -->
                                            <label>Снимка/Схема/Диаграма:</label>
                                            <div class="row">
                                               <div class="col-lg-7">
                                                   <img v-if="question.ctx.picture" :src="question.ctx.picture" width="360">
                                               </div>
                                               <div class="col-lg-5">
                                                   Графичен файл (.png; .jpg; .bmp):
                                                   <div class="row d-flex align-items-end" v-if="question.ctx.picture">
                                                       [[ pictureFileName ]]
                                                   </div>
                                                   <div class="d-flex align-items-end" v-else>
                                                       Няма прикачен файл
                                                   </div>

                                                   <div class="form-icon icon-plus mt--20"
                                                        data-bs-toggle="tooltip"
                                                        data-bs-placement="bottom"
                                                        data-bs-custom-class="custom-tooltip"
                                                        data-bs-title="Choose File">
                                                        <label for="imageInputCtx" class="custom-file-label">
                                                            <i class="feather-paperclip"></i> Прикачи&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </label>
                                                        <input type="file"
                                                               id="imageInputCtx"
                                                               class="input-file"
                                                               @change="onContextImageChange($event)"
                                                               style="display: none;">
                                                   </div>

                                                   <div class="dropdown history-box-dropdown mt--10">
                                                       <button type="button" class="btn-default btn-small btn-border dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                                                            Разположение на текста <i class="feather-more-horizontal"></i>
                                                        </button>
                                                       <ul class="dropdown-menu">
                                                            <li><a class="dropdown-item" @click="question.ctx.textWrap='n'">
                                                                Текста на въпроса е над графичния елемент</a>
                                                            </li>
                                                            <li><a class="dropdown-item" @click="question.ctx.textWrap='s'">
                                                                Текста на въпроса е под графичния елемент</a>
                                                            </li>
                                                            <li><a class="dropdown-item" @click="question.ctx.textWrap='e'">
                                                                Текста на въпроса е в ляво от графичния елемент</a>
                                                            </li>
                                                            <li><a class="dropdown-item" @click="question.ctx.textWrap='w'">
                                                                Текста на въпроса е в дясно от графичния елемент</a>
                                                            </li>
                                                        </ul>
                                                   </div>
                                               </div>
                                           </div>
                                            <!-- Формулировка на въпроса -->
                                            <div class="chat-form">
                                               <div class="border-gradient text-form">
                                                   <div class="form-group ml--10">
                                                       <label for="xt">Формулировка на контекста:</label>
                                                       <textarea id="xt" rows="5"  v-model="question.ctx.text"></textarea>
                                                   </div>
                                               </div>
                                           </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <!-- съдържание на контекста -->
                    <div class="chat-content mb--10" v-if="question.ctx!=null">
                        <div class="row">
                            <!-- картинка и текст -->
                            <div class="row mb--10" v-if="question.ctx.textWrap=='n'">
                                <p class="mb--10">[[ question.ctx.text ]]</p>
                                <div class="col-lg-12 img-box  d-flex justify-content-center">
                                    <img class="radius" :src="question.ctx.picture">
                                </div>
                            </div>
                            <div class="row mb--10" v-if="question.ctx.textWrap=='s'">
                                <div class="col-lg-12 img-box  d-flex justify-content-center">
                                    <img class="radius" :src="question.ctx.picture">
                                </div>
                                <p class="mt--10">[[ question.ctx.text ]]</p>
                            </div>
                            <div class="row mb--10" v-if="question.ctx.textWrap=='e'">
                                <div class="col-lg-6 img-box  d-flex justify-content-center">
                                    [[ question.ctx.text ]]
                                </div>
                                <div class="col-lg-6 img-box  d-flex justify-content-center">
                                    <img class="radius" :src="question.ctx.picture">
                                </div>
                            </div>
                            <div class="row mb--10" v-if="question.ctx.textWrap=='w'">
                                <div class="col-lg-6 img-box  d-flex justify-content-center">
                                    <img class="radius" :src="question.ctx.picture">
                                </div>
                                <div class="col-lg-6 img-box  d-flex justify-content-center">
                                    [[ question.ctx.text ]]
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Картинка -->
                    <label v-if="(question.type==2)||(question.type==4)">Снимка/Схема/Диаграма:</label>
                    <div class="row" v-if="(question.type==2)||(question.type==4)">
                       <div class="col-lg-7">
                           <img v-if="question.picture" :src="question.picture" width="360">
                       </div>
                       <div class="col-lg-5">
                           Графичен файл (.png; .jpg; .bmp):
                           <div class="row d-flex align-items-end" v-if="question.picture">
                               [[ pictureFileName ]]
                           </div>
                           <div class="d-flex align-items-end" v-else>
                               Няма прикачен файл
                           </div>

                           <div class="form-icon icon-plus mt--20"
                                data-bs-toggle="tooltip"
                                data-bs-placement="bottom"
                                data-bs-custom-class="custom-tooltip"
                                data-bs-title="Choose File">
                                <label for="imageInput" class="custom-file-label">
                                    <i class="feather-paperclip"></i> Прикачи&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </label>
                                <input type="file"
                                       id="imageInput"
                                       class="input-file"
                                       @change="onImageChange($event)"
                                       style="display: none;">
                           </div>

                           <div class="dropdown history-box-dropdown mt--10">
                               <button type="button" class="btn-default btn-small btn-border dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                                    Разположение на текста <i class="feather-more-horizontal"></i>
                                </button>
                               <ul class="dropdown-menu">
                                    <li><a class="dropdown-item" @click="question.textWrap='n'">
                                        Текста на въпроса е над графичния елемент</a>
                                    </li>
                                    <li><a class="dropdown-item" @click="question.textWrap='s'">
                                        Текста на въпроса е под графичния елемент</a>
                                    </li>
                                    <li><a class="dropdown-item" @click="question.textWrap='e'">
                                        Текста на въпроса е в ляво от графичния елемент</a>
                                    </li>
                                    <li><a class="dropdown-item" @click="question.textWrap='w'">
                                        Текста на въпроса е в дясно от графичния елемент</a>
                                    </li>
                                </ul>
                           </div>
                       </div>
                   </div>
                    <!-- Формулировка на въпроса -->
                    <div class="chat-form">
                       <div class="border-gradient text-form">
                           <div class="form-group ml--10">
                               <label for="qt">Формулировка на въпроса:</label>
                               <textarea id="qt" rows="5"  v-model="question.text"></textarea>
                           </div>
                       </div>
                   </div>
                    <!-- Отговори -->
                    <div class="row mt--20">
                        <div class="col-lg-10 col-md-10 col-sm-10 col-12">
                            <label v-if="question.type==3">Редове:</label>
                            <label v-else-if="question.type==4">Опции:</label>
                            <label v-else>Отговори:</label>
                        </div>
                    </div>
                    <div class="chat-box-edit bg-flashlight mt--10" v-for="(option, idx) in question.options">
                        <div class="inner top-flashlight leftside light-xl">
                            <div class="chat-section generate-section">
                                <div class="chat-content">
                                    <div class="row">
                                       <div class="col-lg-5 col-md-5 col-sm-5 col-12 d-flex align-items-center">
                                            <span v-if="question.type==3">Ред [[idx + 1]]</span>
                                            <span v-else-if="question.type==4">Опция [[idx + 1]]</span>
                                            <span v-else="question.type==4">Отговор [[idx + 1]]</span>
                                       </div>
                                       <div class="col-lg-3 col-md-3 col-sm-3 col-6" style="text-align: right;">
                                           <div class="btn-grp">
                                               <button class="react-btn btn-default btn-small btn-border"
                                                       style="color: green; border-color: #013401;" @click="copyOption(idx)">
                                                   <i class="feather-x"></i><span>&nbspДублирай</span>
                                               </button>
                                           </div>
                                       </div>
                                       <div class="col-lg-3 col-md-3 col-sm-3 col-6" style="text-align: right;">
                                           <div class="btn-grp">
                                               <button class="react-btn btn-default btn-small btn-border"
                                                       style="color: red; border-color: #5c0000d4;" @click="deleteOption(idx)">
                                                   <i class="feather-x"></i><span>&nbspПремахни</span>
                                               </button>
                                           </div>
                                       </div>
                                       <div class="col-lg-1 col-md-1 col-sm-1 col-2">
                                           <div class="btn-grp">
                                               <button class="react-btn btn-default btn-small btn-border" @click="option.collapsed=!option.collapsed">
                                                   <i class="feather-chevrons-down" style="margin-left: -6px;" v-if="!option.collapsed"></i>
                                                   <i class="feather-chevrons-up" style="margin-left: -6px;" v-else></i>
                                               </button>
                                           </div>
                                       </div>
                                    </div>
                                </div>
                            </div>
                            <div class="chat-section">
                                <div class="chat-content">
                                    <!-- Отговор  Варианти 1 и 2 - Въпрос от затворен тип със или без картинка -->
                                    <div class="row" v-if="(question.type<3)&&(option.collapsed)">
                                        <div class="form-group col-lg-2">
                                            <label :for="'editV1C1'+idx">№/буква</label>
                                            <input type="text" class="form-control"
                                                   :id="'editV1C1'+idx" maxlength="4" size="4" v-model="option.leading_char">
                                        </div>
                                        <div class="custom-control custom-checkbox col-lg-2 align-items-end cb-ok-align"
                                             :class="{'color-Ok':option.checked, 'color-No':!option.checked,}">
                                            <input class="custom-control-input" :id="'editV1C2'+idx" type="checkbox" v-model="option.checked">
                                            <label class="custom-control-label d-flex align-items-center" :for="'editV1C2'+idx">вярно</label>
                                        </div>
                                        <div class="form-group col-lg-8">
                                            <label :for="'editV1C3'+idx">текст</label>
                                            <input type="text" class="form-control" :id="'editV1C3'+idx" v-model="option.text">
                                        </div>
                                    </div>
                                    <div class="row" v-if="(question.type<3)&&(!option.collapsed)">
                                        <div class="col-lg-1"></div>
                                        <div class="col-lg-11">
                                            <div class="rbt-checkbox-wrapper">
                                                <input :id="'editV1C4'+idx"
                                                       type="checkbox" disabled
                                                       :checked="option.checked">
                                                <label :for="'editV1C4'+idx">
                                                    <span :class="{'color-Ok': option.checked, 'color-No': !option.checked}">
                                                        [[ option.leading_char+'. '+option.text]]</span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Отговор  Вариант 3 - Въпрос за съпоставяне -->
                                    <div class="row" v-else-if="(question.type==3)&&(option.collapsed)">
                                        <div class="form-group col-lg-2">
                                            <label :for="'editV3C1'+idx">№/буква</label>
                                            <input type="text" class="form-control" :id="'editV3C1'+idx" maxlength="4" size="4" v-model="option.leading_char">
                                        </div>
                                        <div class="form-group col-lg-3">
                                            <label :for="'editV3C2'+idx">текст</label>
                                            <input type="text" class="form-control" :id="'editV3C2'+idx" v-model="option.text">
                                        </div>
                                        <div class="form-group col-lg-1"></div>
                                        <div class="form-group col-lg-2">
                                            <label :for="'editV3C3'+idx">отговор</label>
                                            <input type="text" class="form-control" :id="'editV3C3'+idx" v-model="option.value">
                                        </div>
                                        <div class="form-group col-lg-4">
                                            <label :for="'editV3C4'+idx">опция</label>
                                            <input type="text" class="form-control" :id="'editV3C4'+idx" v-model="option.value_name">
                                        </div>
                                    </div>
                                    <div class="row mt--5" v-else-if="(question.type==3)&&(!option.collapsed)">
                                        <div class="col-lg-1"></div>
                                        <div class="col-lg-4" style="display: flex; align-items: center;">
                                            <span>[[ option.leading_char+'. '+option.text]]</span>
                                        </div>
                                        <div class="col-lg-1"></div>
                                        <div class="col-lg-1">
                                           <div class="btn-grp">
                                               <button class="react-btn btn-default btn-small btn-border">
                                                   <span style="margin-left: -6px;">[[option.value]]</span>
                                               </button>
                                           </div>
                                        </div>
                                        <div class="col-lg-5" style="display: flex; align-items: center;">
                                            <span >[[option.value_name]]</span>
                                        </div>
                                    </div>
                                    <!-- Отговор  Вариант 4 - Въпрос за съпоставяне от картинка -->
                                    <div class="row" v-else-if="(question.type==4)&&(option.collapsed)">
                                        <div class="form-group col-lg-1"></div>
                                        <div class="form-group col-lg-2">
                                            <label :for="'editV4C1'+idx">отговор</label>
                                            <input type="text" class="form-control" :id="'editV4C1'+idx" v-model="option.value">
                                        </div>
                                        <div class="form-group col-lg-9">
                                            <label :for="'editV4C2'+idx">опция</label>
                                            <input type="text" class="form-control" :id="'editV4C2'+idx" v-model="option.value_name">
                                        </div>
                                    </div>
                                    <div class="row mt--5" v-else-if="(question.type==4)&&(!option.collapsed)">
                                        <div class="form-group col-lg-1"></div>
                                        <div class="col-lg-1">
                                           <div class="btn-grp">
                                               <button class="react-btn btn-default btn-small btn-border">
                                                   <span style="margin-left: -6px;">[[option.value]]</span>
                                               </button>
                                           </div>
                                        </div>
                                        <div class="col-lg-10" style="display: flex; align-items: center;">
                                            <span >[[option.value_name]]</span>
                                        </div>
                                    </div>
                                    <!-- Отговор  Вариант 5 - Въпрос от отворен тип -->
                                    <div class="row" v-else-if="(question.type==5)&&(option.collapsed)">
                                        <div class="form-group col-lg-2"></div>
                                        <div class="form-group col-lg-8">
                                            <label :for="'editV5C1'+idx">текст</label>
                                            <input type="text" class="form-control" :id="'editV5C1'+idx" v-model="option.value">
                                        </div>
                                    </div>
                                    <div class="row" v-else-if="(question.type==5)&&(!option.collapsed)">
                                        <div class="form-group col-lg-2"></div>
                                        <div class="form-group col-lg-8">
                                            <span> [[option.value]] </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- добавяне на отговор -->
                    <div class="chat-box-edit bg-flashlight mt--10">
                        <div class="inner top-flashlight leftside light-xl">
                            <div class="chat-section generate-section">
                                <div class="chat-content">
                                    <div class="row">
                                       <div class="col-lg-12 col-md-12 col-sm-12 col-12" style="text-align: right;">
                                           <div class="btn-grp">
                                               <button class="react-btn btn-default btn-small btn-border"
                                                       style="color: green; border-color: #013401;" @click="addEmptyOption()">
                                                   <i class="feather-x"></i>
                                                   <span v-if="question.type==3">&nbspДобави ред</span>
                                                   <span v-else-if="question.type==4">&nbspДобави опция</span>
                                                   <span v-else>&nbspДобави отговор</span>
                                               </button>
                                           </div>
                                       </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- бутон горе ляво - затваряне на прозореца -->
                    <button class="close-button" data-bs-dismiss="modal">
                       <i class="feather-x"></i>
                   </button>
                    <!-- footer - бутони за отказ/запис -->
                    <div class="row mt--20">
                       <div class="col-lg-2 col-md-2">
                       </div>
                       <div class="col-lg-10 col-md-10 col-sm-10 col-12" style="text-align: right;">
                           <div class="btn-grp">
                               <button class="react-btn btn-default btn-small btn-border bg-color-danger"
                                       data-bs-dismiss="modal">
                                   <i class="feather-x"></i><span>&nbspОткажи</span>
                               </button>
                               &nbsp
                               <button class="react-btn btn-default btn-small btn-border bg-color-success"
                                       data-bs-dismiss="modal" @click="save()">
                                   <i class="feather-check"></i><span>&nbspЗапази</span>
                               </button>
                       </div>
                   </div>
               </div>
                </div>
            </div>
       </div>

        <!-- Списък коментари -->
        <div id="listRemarksModal" class="modal rbt-modal-box like-modal fade" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content wrapper top-flashlight leftside light-xl">
                    <button class="close-button" data-bs-dismiss="modal">
                        <i class="feather-x"></i>
                    </button>
                    <h5 class="title">Бележки (мнения, коментари) към въпрос #[[ remark.task_id]]</h5>
                    <div class="chat-box-edit bg-flashlight mt--10" v-if="remarks.length == 0">
                        <div class="inner top-flashlight leftside light-xl">
                            <div class="chat-section generate-section">
                                <div class="chat-content">
                                    <div class="row">
                                        <div class="col-lg-2 col-md-2 col-sm-2 col-12" style="text-align: right;"></div>
                                        <div class="col-lg-10 col-md-10 col-sm-10 col-12" style="text-align: right;">
                                            <h6>Няма коментари към този въпрос</h6>
                                       </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="chat-box-edit bg-flashlight mt--10" v-if="remarks.length != 0" v-for="rem in remarks">
                        <div class="inner top-flashlight leftside light-xl">
                            <div class="chat-section generate-section">
                                <div class="chat-content">
                                    <div class="row">
                                       <div class="col-lg-12 col-md-12 col-sm-12 col-12">
                                           [[ rem.text]]
                                       </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-lg-6 col-md-6 col-sm-6 col-12"></div>
                                        <div class="col-lg-12 col-md-12 col-sm-12 col-12"  style="text-align: right; font-size: 9px;">
                                           [[ rem.user_name ]]</br>[[ formatDate(rem.date) ]]
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Нов коментар -->
        <div id="newRemarkModal" class="modal rbt-modal-box like-modal fade" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content wrapper top-flashlight leftside light-xl">
                    <h5 class="title">Напишете бележка (мнение, коментар) към въпрос #[[ remark.task_id]]</h5>
                    <div class="chat-form">
                        <div class="border-gradient text-form">
                            <textarea rows="6" placeholder="Вашият текст ..." v-model="remark.text"></textarea>
                        </div>
                    </div>
                    <div class="bottom-btn mt--20">
                        <a class="btn-default btn-small round" data-bs-dismiss="modal" @click="addRemark()">Запази</a>
                    </div>
                    <button class="close-button" data-bs-dismiss="modal">
                        <i class="feather-x"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Избор на тема -->
        <div id="themeSelectModal" class="modal rbt-modal-box copy-modal fade" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content wrapper top-flashlight light-xl">
                    <div class="section-title text-center mb--30 sal-animate" data-sal="slide-up" data-sal-duration="400" data-sal-delay="150">
                        <h6 class="title mb--0 w-600">Изберете тема</h6>
                    </div>
                    <div class="genarator-section">
                        <ul class="genarator-card-group">
                            <li v-for="theme in listOfThemes">
                                <a class="genarator-card" data-bs-dismiss="modal" @click="changeTheme(theme.num)" >
                                        <div class="row">
                                            <div class="col-2">
                                                <h4>[[ theme.num ]]</h4>
                                            </div>
                                            <div class="col-10">
                                                <h6>[[ theme.title ]]</h6>
                                            </div>
                                        </div>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <button class="close-button" data-bs-dismiss="modal">
                        <i class="feather-x"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Списък на въпросите в група -->
        <div id="listGroupModal" class="modal rbt-modal-box like-modal fade" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content wrapper top-flashlight leftside light-xl">
                    <button class="close-button" data-bs-dismiss="modal">
                        <i class="feather-x"></i>
                    </button>
                    <h5 class="title">Група въпроси #[[ temp_int ]]</h5>
                    <div v-for="(item, item_num) in theme">
                        <div v-for="(qst, qst_idx) in item.tasks">
                            <div class="chat-box-edit bg-flashlight mt--10" v-if="qst.group==temp_int">
                                <div class="inner top-flashlight leftside light-xl">
                                    <div class="chat-section generate-section">
                                        <div class="chat-content">
                                            <div class="row">
                                               <div class="col-lg-12 col-md-12 col-sm-12 col-12">
                                                   Въпрос #[[ qst.id]]: [[ qst.text]]
                                               </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

{% endverbatim %}

{% endblock %}

{% block page_script %}
    <script src="{% static 'assets/js/elektra/dzi_questions_editor.js' %}"></script>
{% endblock %}
